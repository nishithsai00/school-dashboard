<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="stylesheet" href="/css/school.css">

<!-- PWA -->
<link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="#2563eb">

<!-- IMPORTANT (you are missing these) -->
<meta name="mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="default">

<!-- ICON -->
<link rel="apple-touch-icon" sizes="192x192" href="/img/icon-192.png">

</head>

<body>

<!-- HEADER -->
<div class="school-header">

    <div style="display:flex;align-items:center;gap:15px;">
        <img src="/img/logo.png">

        <div>
            <div class="school-title">Student Dashboard</div>
            <div class="school-sub">Maddi Subbarao English Medium High School</div>
        </div>
    </div>

    <!-- FIXED LOGOUT BUTTON -->
    <a href="/logout" class="btn btn-danger">Logout</a>

</div>


<div class="page">

    <!-- STUDENT DETAILS -->
    <div class="card-box">
        <h2>Student Details</h2>

        <table>
            <tr><th>Name</th><td th:text="${student.name}"></td></tr>
            <tr><th>Roll No</th><td th:text="${student.rollNo}"></td></tr>
            <tr>
                <th>Class</th>
                <td>
                    <span th:text="${student.className}"></span> -
                    <span th:text="${student.section}"></span>
                </td>
            </tr>
            <tr><th>Father Name</th><td th:text="${student.fatherName}"></td></tr>
            <tr><th>Phone</th><td th:text="${student.phone}"></td></tr>
            <tr><th>Aadhar</th><td th:text="${student.aadhar}"></td></tr>
            <tr><th>Date of Birth</th><td th:text="${student.dob}"></td></tr>
            <tr><th>Address</th><td th:text="${student.address}"></td></tr>
        </table>

    </div>


    <!-- HOMEWORK TABLE (REAL FIX) -->
    <div class="card-box">

        <h2>Homework</h2>

        <table>

            <thead>
                <tr>
                    <th>Subject</th>
                    <th>Homework</th>
                    <th>Date</th>
                </tr>
            </thead>

            <tbody>

            <tr th:each="entry : ${latestHomework}">

                <td th:text="${entry.key}"></td>

                <!-- If homework exists -->
                <td th:if="${entry.value != null}"
                    th:text="${entry.value.homework}">
                </td>

                <td th:if="${entry.value == null}">
                    Waiting for teacher update
                </td>

                <td th:if="${entry.value != null}"
                    th:text="${entry.value.date}">
                </td>

                <td th:if="${entry.value == null}">
                    â€”
                </td>

            </tr>

            </tbody>

        </table>

    </div>

</div>

</body>
</html>
